---
title: "迷ったら既存実装に合わせよう"
emoji: "🧩"
type: "idea"
topics: ["設計", "チーム開発", "コードレビュー", "リファクタリング"]
published: true
---

「この書き方の方が正しい」「このパターンの方がモダンだ」

そう思って新しいコードを書いたのに、あとから見た人を混乱させてしまった経験はないでしょうか。

ソフトウェア開発において「一貫性」は、個々の「正しさ」よりも重要になる場面があります。

## 🤯 一貫性がないと何が起きるか

### 新しく書くときに困る

同じ処理なのにモジュールAとモジュールBで書き方が違う。新しくコードを書くとき、どちらに合わせればいいかわかりません。

実際には深い意図などなく、単に「書いた人が違うから」「書いた時期が違うから」という理由だけかもしれません。しかし書き手にはその文脈が伝わらず、どちらを参考にすべきか迷ってしまいます。

### 「どっちでもいい」議論が増える

レビューで「こっちの書き方の方がいいのでは」「いや、こっちの方が」という議論になりがちです。どちらも間違いではない場合、この議論に正解はありません。一貫したルールがあれば「既存に合わせる」で終わります。

## 🎯 一貫性を大事にする理由

### 「正しさ」は文脈によって変わる

ある書き方が「正しい」かどうかは、見る角度によって変わります。命名、設計パターン、ディレクトリ構造。どれも「唯一の正解」があるわけではありません。

一方で、一貫性は文脈に依存しません。「同じ処理は同じ書き方をする」というシンプルな原則です。

### 部分最適より全体最適

新しく書くコードだけを見れば、より良い書き方があるかもしれません。しかしコードベース全体で見たときに、その「部分的な改善」が全体の一貫性を損なうことがあります。

部分的に正しいコードより、全体として予測可能なコードベースの方が、長期的には価値があります。

### 書く人より読む人のため

コードは書く時間より読まれる時間の方が圧倒的に長いです。書くときに「こっちの方がいい」と思っても、読む人が混乱するなら本末転倒です。

一貫性は、未来の読み手への配慮です。

## ⚖️ 「一貫性」と「改善」のバランス

一貫性を重視しすぎると、悪いコードがそのまま増殖していく懸念があります。どう考えればいいでしょうか。

### 「正しい/間違い」と「好み/スタイル」を分ける

明らかなバグ、セキュリティの問題、非推奨な書き方。これらは「間違い」なので修正すべきです。

一方で、命名の選び方、パターンの選択、構造の設計。これらは「好み」や「スタイル」の問題であることが多いです。どちらも間違いではない場合、一貫性を優先する方が全体としては健全です。

### 「既存は変えず、新規だけ変える」は避ける

新しい書き方の方が良いと思っても、既存を変えないなら新規も合わせる。既存も含めて変えるなら変える。中途半端が一番よくありません。

同じ処理で書き方が異なると、読み手は意図を読み取ろうとして混乱します。

### 既存がおかしい場合の対応

既存の命名や書き方がおかしいと感じた場合は、以下のいずれかで対応します。

- **修正が軽い** → 既存も同時に直す
- **修正が重い** → 一旦既存に合わせ、後でまとめてリファクタリング

「新規だけ直す」という選択肢は避けます。

## 📝 まとめ

一貫性は地味です。「正しいコードを書く」ほどかっこよくありません。

しかしチームで開発している以上、「あとから見た人が混乱しないか」という視点は欠かせません。

- 部分的な正しさより、全体の予測可能性
- 書く人の満足より、読む人への配慮

一貫性を大切にすることは、コードベースと、それを読む未来の誰かへの敬意だと考えています。
