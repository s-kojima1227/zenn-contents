---
title: "【ボトムアップ】ネットワークはなぜつながるのか？"
emoji: "🌊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# なぜこの記事を書くのか

## 既存のネットワーク解説の問題点

多くのネットワーク教材や解説記事には、共通した問題があります。

複雑なHTTPから始めて「では、なぜHTTPが動くかというと...TCPが...」「では、なぜTCPが動くかというと...IPが...」と深掘りしていく説明が多くあります。このような説明は、読者が迷子になりやすく、「今、何の説明をされているのか」「これは全体のどの部分の話なのか」が分からなくなってしまいます。

また、「ネットワークの仕組み」と「それを実現するハードウェアや技術仕様」が混在して説明されることも頻繁にあります。例えば、データリンク層の説明で「共有回線上での通信管理」という本質的な役割と、「イーサネットフレームの具体的なヘッダー構造」という実装詳細が同時に語られ、本質以外の情報が多すぎて脳がパンクしてしまいます。

## この記事が目指すもの

最もシンプルな「2台のデバイスが直接つながってデータを送る」ケースから始めて、「複数台での共有」「異なるネットワーク間の通信」「アプリケーション同士の通信」へと、段階的に複雑さを積み上げていきます。

各層が「なぜ必要なのか」「どんな問題を解決しているのか」という本質的な役割を中心に説明し、技術仕様や実装詳細は最小限に留めます。読者が「ネットワークの構造」を直感的に理解できることを最優先にします。

基盤となる各層の役割を理解した上で、最終的に「WebブラウザがWebサーバーと通信する」という身近な通信がどのような仕組みで実現されているのかを、明確に理解できるようになります。


# 2つのコンピュータ間で0と1を送り合う仕組み

コンピュータ同士が通信するとき、最も基本的な問題があります：

**「2つのコンピュータの間で、どうやって0と1を送り合うのか？」**

すべての通信は、この基本的な問題の解決から始まります。

## コンピュータの言語：0と1

コンピュータは、すべての情報を0と1の組み合わせで表現します。そのためコンピュータ間の通信とは、この0と1の列を相手のデバイスに送ることと言えます。

**参考:** [「0」と「1」でだけで文字や画像も自在に表現、コンピューターの秘密](https://xtech.nikkei.com/atcl/nxt/column/18/00754/051600006/)

## 問題：0と1をどうやって送るのか？

あなたのコンピュータが、隣にあるもう1台のコンピュータに「Hello」を送りたいとします。

コンピュータの中では「Hello」は以下の0と1として存在しています：
```
01001000 01100101 01101100 01101100 01101111
```

でも、この0と1を相手のコンピュータに**どうやって**送るのでしょうか？

## 解決方法：物理的な信号に変換する

この問題を解決するために、0と1を何らかの**物理的な信号**に変換して送ります。

### 方法1：電気信号で送る
- **0** = 低い電圧（例：0V）
- **1** = 高い電圧（例：5V）
- ケーブルを通じて電圧の変化として送信

### 方法2：光信号で送る
- **0** = 光が消灯
- **1** = 光が点灯
- 光の点滅パターンとして送信

### 方法3：電波で送る
- **0と1** = 電磁波の周波数や強さの変化
- 空間を通じて電磁波として送信

## 具体例：「Hello」を電気信号で送る

「Hello」を電気信号で送る場合：

1. **送信側の処理**
   ```
   "Hello" → 01001000 01100101 01101100 01101100 01101111
   ```

2. **電気信号への変換**
   ```
   0 → 0V
   1 → 5V
   0 → 0V
   0 → 0V
   1 → 5V
   ...
   ```

3. **ケーブルでの伝送**
   - この電圧変化がケーブルを通じて相手のコンピュータに伝わる

4. **受信側の処理**
   - 到着した電圧変化を検出
   - 電圧を0と1に戻す
   - 結果：`01001000 01100101 01101100 01101100 01101111`

# TODO: 相手を識別する仕組み？

# 複数のコンピュータが通信する仕組み

前章では、2つコンピュータ間で0と1を送り合う基本的な仕組みがあることを学びました。しかし、実際の環境では2台だけでなく、**複数のコンピュータ**が通信したいことがほとんどです。

## 新たな問題：3台以上のデバイス通信

3台のデバイスがあるとします。この3台が全員お互いに通信したい場合、前章の仕組みだけではどうなるでしょうか？

### 全対全接続の問題

前章の「2つコンピュータ間で直接つなぐ」仕組みだけなら、合計3本の接続が必要です:

![](/images/d1c26ed70f2f65/3netwok.png)

### デバイスが増えると...

もし5台のデバイスがあったら：
- 5 × 4 ÷ 2 = **10本の接続が必要**

もし10台なら：
- 10 × 9 ÷ 2 = **45本の接続が必要**

これは現実的ではありませんね。

## 解決策：共有回線の導入

この問題を解決するために、**ハブ**という仕組みを使います。全てのコンピュータが1つのハブにつながり、そのハブを通じて通信する仕組みです。

![](/images/d1c26ed70f2f65/hub.png)

**必要な接続：各デバイスから共有回線まで1本ずつ = 3本だけ**

## ハブを介した通信

前章で学んだ通り、回線に情報を流せば、その回線につながった全てのデバイスに情報が届きます。

### 通信例

デバイスAがデバイスBに「Hello」を送りたい場合：

1. **デバイスAの送信**
   ```
   [デバイスAのアドレス][デバイスBのアドレス][Hello のデータ]
   ```
   
2. **共有回線での伝送**
   - この情報が共有回線を流れる
   
3. **全デバイスでの受信**
   - デバイスA、B、C 全てがこの情報を受信
   
4. **各デバイスでの判定**
   - デバイスB：「これは自分宛だ」→ データを処理
   - デバイスC：「これは自分宛ではない」→ データを無視

## 新たな課題：特定の相手だけに送りたい

しかし、この仕組みには問題があります：

**「特定の相手だけに送りたい」**

- デバイスAがデバイスBだけに送りたい情報も、デバイスCが受信してしまう
- プライベートな1対1通信ができない

現実世界では、私たちは特定の人だけに話しかけることができます。同じことをネットワークでも実現したいですね。

## 解決策：共有回線管理デバイス

この問題を解決するために、**共有回線管理デバイス**を導入します。

```
   デバイスA
      ↓
管理デバイス ←── デバイスB
      ↓
   デバイスC
```

## 特定の相手だけに送る仕組み

この管理デバイスが特定の相手だけに送ることを可能にします。仕組みは以下の通りです：

### 1. デバイスには固有のMACアドレスがある
各デバイスには、**MACアドレス**という固有の識別子が割り当てられています。
- デバイスA：MACアドレス「AA:BB:CC:DD:EE:F1」
- デバイスB：MACアドレス「AA:BB:CC:DD:EE:F2」  
- デバイスC：MACアドレス「AA:BB:CC:DD:EE:F3」

### 2. 管理デバイスが「誰がどこにいるか」を知っている
管理デバイスは、各MACアドレスがどの接続口につながっているかを把握しています：
- MACアドレス「AA:BB:CC:DD:EE:F1」→ ポート1（デバイスA）
- MACアドレス「AA:BB:CC:DD:EE:F2」→ ポート2（デバイスB）
- MACアドレス「AA:BB:CC:DD:EE:F3」→ ポート3（デバイスC）

### 3. 全てのデータが管理デバイスを経由する
デバイス同士の通信は、必ず管理デバイスを通ります。

## 動作例

デバイスAがデバイスBだけに「Hello」を送る場合：

1. **デバイスA → 管理デバイス**
   ```
   [送信元:AA:BB:CC:DD:EE:F1][宛先:AA:BB:CC:DD:EE:F2][Hello のデータ]
   ```

2. **管理デバイスでの処理**
   - 宛先「AA:BB:CC:DD:EE:F2」を確認
   - 「AA:BB:CC:DD:EE:F2はポート2にいる」と判断
   - ポート2（デバイスB）のみにデータを送信

3. **結果**
   - デバイスBのみがデータを受信
   - デバイスCは何も受信しない

## この仕組みの実現

特定の相手だけに送る通信が、以下の3つの要素で実現されました：

1. **デバイスに固有のMACアドレスがある**
2. **管理デバイスが「誰がどこにいるか」を知っている**
3. **全デバイスが管理デバイスを経由して通信する**

これにより、効率的で安全なネットワーク通信が可能になります。

---

**この章のまとめ：**
共有回線で効率化し、管理デバイスがアドレスと接続場所を把握することで、特定の相手だけに送る通信を実現する。

# 異なるネットワーク間での通信

## 前章で分かったこと

前章では、1つの管理デバイス配下で複数のデバイスが効率的に通信できる仕組みを学びました。

しかし、現実の世界では、**異なる場所にある複数のネットワーク**が存在し、それらの間でも通信したいケースがあります。

## 新たな問題：複数のネットワーク間での通信

例えば、以下のような状況を考えてみましょう：

**4つの独立したネットワーク**
```
ネットワークA           ネットワークB
  デバイスA1               デバイスB1
     ↓                       ↓
管理デバイス1 ←── デバイスA2   管理デバイス2 ←── デバイスB2

ネットワークC           ネットワークD
  デバイスC1               デバイスD1
     ↓                       ↓
管理デバイス3 ←── デバイスC2   管理デバイス4 ←── デバイスD2
```

**問題：任意のネットワークのデバイス同士が通信したい**
- ネットワークAのデバイスA1 → ネットワークCのデバイスC1
- ネットワークBのデバイスB2 → ネットワークDのデバイスD1
- など、全てのパターンの通信

前章で学んだMACアドレスの仕組みでは、この通信はできません。なぜでしょうか？

### MACアドレスの限界

1. **各管理デバイスは自分のネットワーク内しか知らない**
   - 管理デバイス1はデバイスA1、A2のMACアドレスしか知らない
   - 他のネットワークのデバイス（B1、C1、D1など）は把握していない

2. **物理的に直接接続されていない**
   - 各ネットワークが独立しており、直接の接続がない

## 解決策1：全ての管理デバイス同士をつなぐ

最も単純な解決策は、**全ての管理デバイス同士を直接つなぐ**ことです。

```
管理デバイス1 ←→ 管理デバイス2
    ↑ ＼          ↗ ↑
    ↓   ＼      ↙   ↓
管理デバイス4 ←→ 管理デバイス3
```

### この方法の問題点

しかし、この方法には深刻な問題があります：

**接続数の爆発的増加**
- 4つのネットワーク：6本の接続が必要
- 10個のネットワーク：45本の接続が必要
- 100個のネットワーク：4,950本の接続が必要

**管理の複雑さ**
- 各管理デバイスが他の全ての管理デバイスを把握する必要
- 新しいネットワークが追加されるたびに、全ての既存ネットワークの設定を変更

**アドレス重複の問題**
- 各ネットワーク内でのみMACアドレスが管理されている
- 異なるネットワーク間で同じMACアドレスが重複する可能性

## 解決策2：階層的なアドレス体系

この問題を根本的に解決するために、**階層的なアドレス体系**を導入します。

### 新しいアドレス：IPアドレス

各デバイスに、MACアドレスとは別の新しいアドレスを割り当てます：**IPアドレス**

**IPアドレスの特徴：**
- **ネットワーク部** + **ホスト部** の階層構造
- 同じネットワーク内のデバイスは、同じネットワーク部を持つ

### IPアドレスの例

**ネットワークA（ネットワーク部：192.168.1）**
- デバイスA1：192.168.1.10
- デバイスA2：192.168.1.20

**ネットワークB（ネットワーク部：192.168.2）**
- デバイスB1：192.168.2.10
- デバイスB2：192.168.2.20

**ネットワークC（ネットワーク部：10.0.1）**
- デバイスC1：10.0.1.10
- デバイスC2：10.0.1.20

**ネットワークD（ネットワーク部：10.0.2）**
- デバイスD1：10.0.2.10
- デバイスD2：10.0.2.20

## ルーターの導入

この階層的アドレス体系を活用するために、**ルーター**という新しいデバイスを導入します。

```
ネットワークA      中央ルーター      ネットワークB
  デバイスA1          ↑               デバイスB1
     ↓               ↑                  ↓
管理デバイス1 ←── ルーター1 ←────→ ルーター2 ←── 管理デバイス2
                     ↓
                     ↓
ネットワークC    中央ルーター      ネットワークD
  デバイスC1          ↑               デバイスD1
     ↓               ↑                  ↓
管理デバイス3 ←── ルーター3 ←────→ ルーター4 ←── 管理デバイス4
```

### ルーターの役割

ルーターは「**IPアドレスを見て適切な方向にデータを転送する**」役割を持ちます：

1. **宛先IPアドレスのネットワーク部を確認**
   - 192.168.1.x → ネットワークA方向
   - 192.168.2.x → ネットワークB方向
   - 10.0.1.x → ネットワークC方向
   - 10.0.2.x → ネットワークD方向

2. **階層的なルーティング**
   - 「192.168.x.x」のグループ → 上側の中央ルーター経由
   - 「10.0.x.x」のグループ → 下側の中央ルーター経由

## 実際の通信の流れ

### 例1：同じグループ内の通信
ネットワークAのデバイスA1（192.168.1.10）がネットワークBのデバイスB1（192.168.2.10）に「Hello」を送る場合：

**1. デバイスA1での処理**
```
[送信元IP: 192.168.1.10][宛先IP: 192.168.2.10][Hello のデータ]
```

**2. ルーター1での処理**
- 宛先IP「192.168.2.10」を確認
- 「192.168.x.xは同じグループ → 直接ルーター2へ」と判断

**3. ルーター2からデバイスB1へ配送**

### 例2：異なるグループ間の通信
ネットワークAのデバイスA1（192.168.1.10）がネットワークCのデバイスC1（10.0.1.10）に「Hello」を送る場合：

**1. デバイスA1での処理**
```
[送信元IP: 192.168.1.10][宛先IP: 10.0.1.10][Hello のデータ]
```

**2. ルーター1での処理**
- 宛先IP「10.0.1.10」を確認
- 「10.0.x.xは異なるグループ → 中央ルーター経由」と判断

**3. 中央ルーターでの処理**
- 「10.0.1.xはネットワークC → ルーター3の方向」と判断

**4. ルーター3からデバイスC1へ配送**

## 階層的アドレスの恩恵

この仕組みにより、以下が実現されます：

### 効率的なルーティング
- ルーター1は「192.168.x.x」と「10.0.x.x」を区別するだけ
- 詳細な宛先（10.0.1と10.0.2の違い）は中央ルーターが判断
- 各ルーターが全ての詳細を覚える必要がない

### スケーラビリティ
- 新しいネットワーク（例：192.168.3.x）を追加しても、既存のルーターの設定変更は最小限
- 階層構造により、ネットワークが増えても管理が複雑になりにくい

## この仕組みで解決されたこと

異なるネットワーク間の通信が、以下の要素で実現されました：

1. **階層的IPアドレス**
   - ネットワーク部とホスト部で、どのネットワークのどのデバイスかを特定

2. **ルーターによる中継**
   - 異なるネットワーク間でデータを転送する専用デバイス

3. **2層のアドレス体系**
   - IPアドレス：最終的な宛先を指定
   - MACアドレス：直接接続された機器間での転送に使用

---

**この章のまとめ：**
階層的なIPアドレスとルーターにより、異なるネットワーク間での通信が可能になる。IPアドレスで最終宛先を指定し、ルーターが適切な経路で中継する。

# 世界中のネットワークをつなぐインターネット

## 前章で分かったこと

前章では、4つのプライベートなネットワーク（A,B,C,D）がルーターでつながり、IPアドレスを使って相互に通信できる仕組みを学びました。

しかし、現実の世界では、世界中に無数のネットワークが存在し、それらが相互に通信しています。

## 新たな問題：プライベートIPアドレスの限界

前章の例では、4つのネットワークが以下のようなIPアドレスを使っていました：
- ネットワークA：192.168.1.x
- ネットワークB：192.168.2.x
- ネットワークC：10.0.1.x
- ネットワークD：10.0.2.x

しかし、これらのアドレスには重要な特徴があります：**プライベートIPアドレス**と呼ばれ、限定された範囲でのみ使用可能なアドレスです。

### プライベートIPアドレスの問題

世界中のネットワークで同じプライベートIPアドレスが使われています：
- 東京の会社A：192.168.1.10を使用
- ニューヨークの会社B：192.168.1.10を使用
- ロンドンの家庭C：192.168.1.10を使用

**問題：同じアドレスが世界中で重複している**

もし世界中のネットワークを直接つなげたら、「192.168.1.10」宛てのデータをどこに送ればよいか分からなくなってしまいます。

## 解決策：グローバルIPアドレス

この問題を解決するために、**グローバルIPアドレス**という仕組みがあります。

### グローバルIPアドレスとは

**世界中で唯一無二のIPアドレス**
- 例：203.0.113.50（東京のWebサーバー）
- 例：198.51.100.10（ニューヨークのメールサーバー）
- 例：192.0.2.1（ロンドンの動画サーバー）

これらのアドレスは世界中で重複しないよう、国際的な組織によって管理されています。

### インターネットとは

**インターネット = 世界中のネットワークをグローバルIPアドレスでつないだ巨大なネットワーク**

```
[東京のネットワーク]
   プライベート網
   192.168.1.x
        ↓
   境界ルーター ←── グローバルIP: 203.0.113.1
        ↓
    インターネット
        ↓
   境界ルーター ←── グローバルIP: 198.51.100.1
        ↓
   プライベート網
   192.168.1.x
[ニューヨークのネットワーク]
```

## なぜNATが必要なのか

しかし、ここで新たな問題が生じます。

### グローバルIPアドレスの枯渇問題

**現実：**
- 世界中のデバイス数：数百億台
- 利用可能なIPv4アドレス：約43億個
- **全てのデバイスにグローバルIPアドレスを割り当てることは不可能**

つまり、世界中の全てのデバイスに固有のグローバルIPアドレスを与えることはできません。

**そこで必要になるのがNAT（Network Address Translation）です。**

## NATの仕組み

NATは、プライベートIPアドレスとグローバルIPアドレスを変換する仕組みです。

### 基本的な動作

**家庭やオフィスのネットワーク構成：**
```
[プライベートネットワーク]
デバイスA（192.168.1.10）
デバイスB（192.168.1.20）  →  NATルーター  →  インターネット
デバイスC（192.168.1.30）     グローバルIP: 203.0.113.1
```

### NATの動作例

デバイスA（192.168.1.10）がWebサイト（198.51.100.80）にアクセスする場合：

**1. 送信時の変換**
```
元のデータ:
[送信元: 192.168.1.10:12345][宛先: 198.51.100.80:80][データ]
↓
NATルーターで変換:
[送信元: 203.0.113.1:30001][宛先: 198.51.100.80:80][データ]
```

**2. NATテーブルへの記録**
NATルーターは変換情報を記録：
```
内部: 192.168.1.10:12345 ←→ 外部: 203.0.113.1:30001
```

**3. 応答時の逆変換**
```
Webサイトからの応答:
[送信元: 198.51.100.80:80][宛先: 203.0.113.1:30001][データ]
↓
NATルーターで逆変換:
[送信元: 198.51.100.80:80][宛先: 192.168.1.10:12345][データ]
```

### 複数デバイスの同時通信

**NATは複数のプライベートIPアドレスを1つのグローバルIPアドレスで共有：**

```
デバイスA（192.168.1.10:12345） → 203.0.113.1:30001
デバイスB（192.168.1.20:12346） → 203.0.113.1:30002
デバイスC（192.168.1.30:12347） → 203.0.113.1:30003
```

各デバイスの通信は異なる外部ポート番号で区別されます。

## NATがもたらす恩恵

### 1. IPアドレスの節約
- 1つのグローバルIPで複数のデバイスがインターネット接続可能
- IPv4アドレス枯渇問題の緩和

### 2. セキュリティの向上
- 外部から内部デバイスへの直接アクセスを防止
- プライベートネットワークの隠蔽

### 3. ネットワーク構成の柔軟性
- 内部ネットワークの構成を自由に変更可能
- 外部に影響を与えずに内部IPアドレスを再編成

## この仕組みで実現されたこと

世界規模のインターネット通信が、以下の要素で実現されました：

1. **グローバルIPアドレス**
   - 世界中で一意のアドレスにより、どこからでもアクセス可能

2. **NAT（アドレス変換）**
   - 限られたグローバルIPアドレスを効率的に活用
   - プライベートネットワークのセキュリティを確保

3. **階層的なネットワーク構造**
   - ローカル（プライベート）→ グローバル（インターネット）の階層

---

**この章のまとめ：**
インターネットは世界中のネットワークをグローバルIPアドレスでつないだ巨大なネットワーク。NATにより、限られたグローバルIPアドレスを効率的に共有し、プライベートネットワークのセキュリティを保ちながら世界中と通信できる。

# 同じデバイス内の複数アプリケーション間通信

## 前章で分かったこと

前章では、異なるネットワーク間でデバイス同士が通信できる仕組みを学びました。

しかし、実際の利用では、**1つのデバイス内で複数のアプリケーション**が、それぞれ異なる相手と通信したいケースがほとんどです。

## 新たな問題：1つのデバイスで複数の通信

例えば、あなたのパソコンで以下のことを同時にやっているとします：

- **Webブラウザ**でニュースサイトを見る
- **メールアプリ**でメールを送受信する  
- **動画アプリ**で動画を視聴する

```
あなたのパソコン（192.168.1.10）
├── Webブラウザ　　→ ニュースサイト（203.0.113.50）
├── メールアプリ　　→ メールサーバー（203.0.113.100）
└── 動画アプリ　　　→ 動画サーバー（203.0.113.200）
```

**問題：**
前章で学んだIPアドレスの仕組みでは、データが「あなたのパソコン（192.168.1.10）」に届きますが、**どのアプリケーション宛のデータか分からない**

### 具体的な問題例

ニュースサイトからデータが届いた時：
```
[送信元IP: 203.0.113.50][宛先IP: 192.168.1.10][ニュースデータ]
```

このデータは：
- Webブラウザに渡すべき？
- メールアプリに渡すべき？
- 動画アプリに渡すべき？

**IPアドレスだけでは判断できません。**

同様に、メールサーバーや動画サーバーからデータが来た時も、どのアプリに渡せばよいか分からなくなってしまいます。

## 解決策：ポート番号の導入

この問題を解決するために、**ポート番号**という仕組みを導入します。

### ポート番号とは

ポート番号は、**同じデバイス内の異なるアプリケーションを識別する番号**です。

**概念的には「部屋番号」のようなもの：**
- IPアドレス = 建物の住所（192.168.1.10）
- ポート番号 = 建物内の部屋番号（12345、12346、12347など）

### ポート番号の割り当て例

**あなたのパソコン側：**
```
あなたのパソコン（192.168.1.10）
├── Webブラウザ　　→ ポート番号 12345
├── メールアプリ　　→ ポート番号 12346  
└── 動画アプリ　　　→ ポート番号 12347
```

**サーバー側も同様：**
```
ニュースサイト（203.0.113.50）
└── Webサーバー　　→ ポート番号 80

メールサーバー（203.0.113.100）  
└── メールサービス　→ ポート番号 25

動画サーバー（203.0.113.200）
└── 動画サービス　　→ ポート番号 443
```

## 新しい通信の仕組み

ポート番号を使った通信では、以下の4つの情報でアプリケーション間の通信を特定します：

```
[送信元IP][送信元ポート][宛先IP][宛先ポート][データ]
```

### 通信例

Webブラウザがニュースサイトからデータを受信する場合：

```
[送信元IP: 203.0.113.50][送信元ポート: 80]
[宛先IP: 192.168.1.10][宛先ポート: 12345]
[ニュースデータ]
```

**この情報から：**
- データの送信元：ニュースサイト（203.0.113.50）のWebサーバー（ポート80）
- データの宛先：あなたのパソコン（192.168.1.10）のWebブラウザ（ポート12345）

パソコンは「ポート12345宛てなので、Webブラウザに渡そう」と正確に判断できます。

### 同時通信の例

3つのアプリが同時に通信している時：

**Webブラウザ宛てのデータ：**
```
[送信元: 203.0.113.50:80][宛先: 192.168.1.10:12345][ニュースデータ]
→ ポート12345 = Webブラウザに配送
```

**メールアプリ宛てのデータ：**
```
[送信元: 203.0.113.100:25][宛先: 192.168.1.10:12346][メールデータ]
→ ポート12346 = メールアプリに配送
```

**動画アプリ宛てのデータ：**
```
[送信元: 203.0.113.200:443][宛先: 192.168.1.10:12347][動画データ]
→ ポート12347 = 動画アプリに配送
```

## ポート番号の管理

### クライアント側のポート番号

クライアント（あなたのパソコンのアプリ）は、通信開始時に**適当な空いているポート番号**を自動的に選択します：
- Webブラウザ：12345番（自動選択）
- メールアプリ：12346番（自動選択）
- 動画アプリ：12347番（自動選択）

### サーバー側のポート番号

サーバーは、**決まったポート番号**で待機しています：
- Webサーバー：80番（HTTP用の標準ポート）
- メールサーバー：25番（SMTP用の標準ポート）
- 動画サーバー：443番（HTTPS用の標準ポート）

これにより、クライアントは「ニュースを見たい→ポート80に接続」「メールを送りたい→ポート25に接続」と、目的に応じて適切なサーバーのポートに接続できます。

## この仕組みで解決されたこと

ポート番号の導入により、以下が実現されました：

1. **アプリケーションの識別**
   - 同じデバイス内の複数アプリを正確に区別できる

2. **複数の同時通信**
   - 1つのデバイスで複数のアプリが同時に異なる相手と通信可能

3. **サービスの識別**
   - サーバー側で提供する複数のサービス（Web、メール、動画など）を区別

---

**この章のまとめ：**
ポート番号により、同じデバイス内の複数アプリケーションを識別し、それぞれが独立して異なる相手と通信できるようになる。
